
- name: 检查对方更新
  id: check
  run: |
    echo "=== 开始检测 ==="
    
    # 添加远程仓库
    git remote add matsuzaka https://github.com/matsuzaka-yuki/FolkPatch.git 2>/dev/null || true
    git fetch matsuzaka
    
    # 获取提交哈希
    LOCAL=$(git rev-parse HEAD)
    REMOTE=$(git rev-parse matsuzaka/main)
    
    echo "本地提交: $LOCAL"
    echo "远程提交: $REMOTE"
    
    # 详细比较
    if [ "$LOCAL" = "$REMOTE" ]; then
      echo "✅ 状态：无更新（代码相同）"
      echo "has_updates=false" >> $GITHUB_OUTPUT
    else
      echo "🔄 状态：发现更新！"
      echo "has_updates=true" >> $GITHUB_OUTPUT
      echo "new_commit=$REMOTE" >> $GITHUB_OUTPUT
      
      # 显示新提交内容
      echo ""
      echo "📝 新提交内容："
      git log --oneline HEAD..matsuzaka/main
    fi
    
    echo "=== 检测结束 ==="
